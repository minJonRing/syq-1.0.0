(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3be387b0"],{1388:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"project-edit"},[i("info")],1)},o=[],n=i("4852"),s={name:"ProjectEdit",components:{Info:n["a"]},data:function(){return{}}},r=s,l=i("2877"),c=Object(l["a"])(r,a,o,!1,null,null,null);t["default"]=c.exports},"24d2":function(e,t,i){"use strict";var a=i("b775"),o={getList:function(e){return Object(a["a"])({url:"/project/list",method:"get",params:e})},add:function(e){return Object(a["a"])({url:"/project/add",method:"post",data:e})},edit:function(e){return Object(a["a"])({url:"/project/upload",method:"post",data:e})},detail:function(e){return Object(a["a"])({url:"/project/detail",method:"get",params:e})}};t["a"]=o},"3a43":function(e,t,i){},4852:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"project-index"},[i("div",{staticClass:"box"},[i("el-form",{ref:"form",attrs:{"label-position":"left",model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"项目名称"}},[i("el-input",{attrs:{placeholder:"请输入项目名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"项目类型"}},[i("el-select",{staticClass:"w100",attrs:{placeholder:"请选择项目类型",clearable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.typelist,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"排序"}},[i("el-input-number",{staticClass:"w100",attrs:{min:1,max:1e3,label:"描述文字"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"封面"}},[i("img-show",{ref:"cover",attrs:{url:e.form.cover}})],1),e._v(" "),i("el-form-item",{attrs:{label:"外部视频"}},[i("el-switch",{model:{value:e.form.isOutVideo,callback:function(t){e.$set(e.form,"isOutVideo",t)},expression:"form.isOutVideo"}})],1),e._v(" "),e.form.isOutVideo?i("el-form-item",{staticClass:"t-el-form-item",attrs:{label:"视频"}},[i("el-input",{attrs:{placeholder:"请输入视频地址",clearable:""},model:{value:e.inputVideo,callback:function(t){e.inputVideo=t},expression:"inputVideo"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleAddVideo}},[e._v("添加")])],1):e._e(),e._v(" "),e.form.isOutVideo?e._e():i("el-form-item",{attrs:{label:"上传视频"}},[i("el-button",{staticClass:"video-upload",attrs:{type:"primary"}},[i("span",[e._v("视频上传")]),e._v(" "),i("input",{attrs:{id:"video",type:"file",name:"file",accept:"video/*"},on:{change:e.handleUploadVideo}})])],1),e._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.videoList.length,expression:"videoList.length"}],staticClass:"w100",attrs:{label:"视频列表"}},e._l(e.videoList,(function(t,a){return i("div",{key:a,staticClass:"video-item-box"},[i("span",{staticClass:"delete-video",on:{click:function(t){return e.handleDeleteVideo(a)}}},[i("i",{staticClass:"el-icon-delete"})]),e._v(" "),e.handleBool(t)?i("video",{staticClass:"video-item",attrs:{src:t,autoplay:"",controls:""}}):i("div",{staticClass:"video-item",domProps:{innerHTML:e._s(t)}})])})),0),e._v(" "),i("el-form-item",{staticClass:"w100",attrs:{label:"文本内容"}},[i("div",{ref:"editor"})]),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)],1)])},o=[],n=(i("96cf"),i("3b8d")),s=i("75fc"),r=(i("28a5"),i("24d2")),l=i("91b6"),c=i("db49"),d=i("1a0b"),u=i.n(d),m={name:"ProjectIndex",data:function(){return{fullscreenLoading:!1,typelist:c["a"].type,videoList:[],inputVideo:"",form:{name:"",type:1,sort:1,cover:"",isLong:!1,isOutVideo:!0,video:"",content:""},editor:null}},mounted:function(){var e=this,t=this.$route.query.id;this.handleEditorInit(),t&&r["a"].detail({id:t}).then((function(t){var i=t.data;e.form=Object.assign({},t.data),e.videoList=i.video.split(),e.editor.txt.html(i.content)}))},methods:{handleEditorInit:function(){var e=this;this.editor=new u.a(this.$refs.editor),this.editor.customConfig.uploadImgServer="/upload/img",this.editor.customConfig.uploadFileName="file",this.editor.customConfig.onchange=function(t){e.editor.Content=t},this.editor.create()},handleAddVideo:function(){if(this.inputVideo){var e=Object(s["a"])(this.videoList);e.push(this.inputVideo),this.videoList=Object(s["a"])(e),this.inputVideo="",this.$message.success("添加成功")}},handleUploadVideo:function(e){var t=this;this.fullscreenLoading=!0;var i=e.target.files[0],a=new FormData;a.append("file",i),Object(l["a"])(a,"video").then((function(e){var i=Object(s["a"])(t.videoList);200===e.code&&(i.push(e.data[0]),t.videoList=Object(s["a"])(i)),t.fullscreenLoading=!1,t.$message.success(e.msg)}))},handleDeleteVideo:function(e){var t=Object(s["a"])(this.videoList);t.splice(e,1),this.videoList=Object(s["a"])(t)},handleSubmit:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs.cover.$refs.file.files[0],!t){e.next=8;break}return i=new FormData,i.append("file",t),e.next=6,Object(l["a"])(i);case 6:a=e.sent,this.form.cover=a.data[0];case 8:this.form.content=this.editor.txt.html(),this.form.id?r["a"].edit(this.form).then((function(e){o.$message.success(e.msg),e.code})):r["a"].add(this.form).then((function(e){o.$message.success(e.msg),e.code}));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleBool:function(e){return!!/(^(\/upload))/i.test(e)}}},f=m,v=(i("c198"),i("d25f"),i("2877")),p=Object(v["a"])(f,a,o,!1,null,"91012188",null);t["a"]=p.exports},"91b6":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i("b775");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"img";return Object(a["a"])({url:"/upload/"+t,method:"post",data:e})}},c198:function(e,t,i){"use strict";var a=i("3a43"),o=i.n(a);o.a},d25f:function(e,t,i){"use strict";var a=i("da1a"),o=i.n(a);o.a},da1a:function(e,t,i){},db49:function(e,t,i){"use strict";t["a"]={type:[{value:1,name:"1"},{value:2,name:"2"},{value:3,name:"3"},{value:4,name:"4"}]}}}]);